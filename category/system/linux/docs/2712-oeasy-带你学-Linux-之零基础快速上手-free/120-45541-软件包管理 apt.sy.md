---
show: step
version: 1.0
enable_checker: true
---

# 本章回顾

## 我们来回顾一下 😌

> 上一部分我们都讲了什么？🤔

- yes 命令
- 持续输出某字符串

```shell
yes oeasy
```

**还有什么好玩的命令吗？**🤔

## 列出所有包

```shell
apt list
```

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210910-1631245029533)

- yes 属于coreutils里面的一个命令
- 如何进行包管理呢？

### dpkg


```shell
# 找到 yes 对应位置
which yes
# /usr/bin/yes 属于哪个包
dpkg -S /usr/bin/yes
# 在已经安装的包里面找到 coreutil
dpkg -l coreutils
# coreutils 到底是干什么的？
dpkg -s coreutils
# 在已安装列表中搜索 coreutils
```

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210910-1631245089560)

- dpkg 对应 Debian Package 是传统包管理
- dpkg 更多的是本地包的各种安装卸载查看
- 早年间都是通过 ftp 下载到本地
- 再 dkpg 
- 现在有http了
- 用 apt

### apt
```
apt list coreutils
# 在源中搜索 coreutils
apt search coreutils
```

- apt 是新的包管理工具 😍
- apt 是 advanced package tools 的意思
- apt 是 debian 系发行版的软件包管理工具

### apt🧩

- 其他家族包管理
	- 红帽系的 yum
	- arch 系的 pacman 
	- 也是很好的管理工具
- 如果有些包你是从红帽系 rpm 下载的
  - 可以用 alien 转化为 deb
  - 然后安装 deb 文件
- 那么可以用 apt 下好玩的包吗？😂


### 为什么要用这个工具 🔧

- 不同的 cpu 架构要用不同的二进制文件
- 你可以有两种方法得到某种架构（比如 mips) 的二进制文件
  - 直接下载这个架构的二进制文件
  - 下载这个软件包的源文件，自己编译 ⚙️

**但是这个得到的二进制文件还是有可能不能用，比如：**

软件包之间是有依赖关系的，这个软件包依赖的软件包不存在，甚至被依赖的软件包所依赖的软件包不存在，这就形成了一条链路，我们就需要把这条链路上所有的软件包都下载下来。

**有没有更便捷的方法呢？当然有，我们可以：**

- 使用 apt 把相关操作封装成接口
- 我们直接调用 apt 就可以了
- 所以叫做高级包管理工具
- 高级就高级在这了当然你得有地方下载
- 这就需要镜像站

### 镜像站 (mirrors)

**可以理解为软件包放在网络上。**

我们可以自己访问 [debian 系的镜象列表](https://www.debian.org/mirror/list) 查看，这里面其实对应的就是我们 `/etc/apt/sources.list`


**镜像站一般也不只提供一个发行版的镜像。**
![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210910-1631245850086)

### 清华源

以 [清华镜像站](https://mirror.tuna.tsinghua.edu.cn/) 为例：

  - 有好多发行版
  - 点击发行版或软件包后面问号
  - 可以获得 `sources.list` 的相关清华源配置代码

![Image text](https://labfile.oss.aliyuncs.com/courses/2712/mirror.png)

### 阿里源
- 实验楼里面默认的是阿里源也很好用
- 我们要下载一个应用 linuxlogo
- 我先看看我设置的这些源🤪

### sources.list🗒

**sources.list 语法是这样的：**

- deb url distribution component1 component2 component3 [..] componentX
- deb-src url distribution component1 component2 component3 [..] componentX
- deb 对应二进制文件
- deb-src 对应源文件
- 在地址后面有个版本号
- 版本在 dists(distribution) 里面可以找到
  - <https://mirror.tuna.tsinghua.edu.cn/debian/dists/>
  - debian 系列版本号都是玩具总动员中的角色
  - ubuntu 版本号来自于动物 🦊
  - main、contribute 是文件夹的名字
  - Buster 版是最新的稳定版，适合拿来使用
- 维护者维护的源头是源文件
  - 有了源文件，可以编译成到各种架构的二进制文件
  - 修改也是，先修改源文件

### 周期
各种版本的生命周期

![Image text](https://labfile.oss.aliyuncs.com/courses/2712/release-cycle.png)

### package🎁

**软件包发布的过程生命周期：**

![Image text](https://labfile.oss.aliyuncs.com/courses/2712/package-lifecycle.png)

### 查找和下载安装

```shell
# 搜索源里面有没有 linuxlogo 这个软件包
apt search linuxlogo
# 看看镜像站上面对于这个软件包的描述
apt show linuxlogo
# 下载安装这个软件包
apt install linuxlogo
```

- `search` 查找到你的当前架构是否可以有这个软件包
- `show` 显示开发者 简介 大小 所在的源的位置
  - 我们可以 `apt show apt` 看看 apt 的依赖关系
  - (A 或 B) 且 C 的关系写作 A | B, C
- 第三条执行不下去，因为没有权限
- 这很显然 
- 需要sudo
- 后事如何呢？🤔 
- 且听下个实验再分解！👋
