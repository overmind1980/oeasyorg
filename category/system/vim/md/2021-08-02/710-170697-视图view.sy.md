---
show: step
version: 1.0
enable_checker: true
---

# 视图view

## 回忆上次折叠的细节

- 折叠方式很多
	- 我们一般就用默认的就行
	- indent也很好用，前提是缩进语法严格到位
- zc、zo是打开关闭当前行
- zm、zr可以改变foldlevel
- `:{range}foldopen!`可以在范围内打开行
- `:{range}foldclose!`可以在范围内关闭行
- 但是这个折叠一关闭就没了
- 可以这个折叠状态保存住么？🤔

### mkview

- `mkview`可以创造一个视图
- make a view

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210724-1627097416588)

- 这个视图存储在viewdir
- 我们可以查看这个option的位置
- `:set viewdir?`
- 位置在`$VIM/vimfiles/view`下面
- 我们具体去看一下


### viewdir
- `:!ls $VIM/vimfiles/view`
- 貌似现在还没有这个文件夹

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210724-1627097669533)

- 原因应该是还没有`:mkview`
- 我们退出帮助
- 回到`oeasy.java`来`mkview`

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210724-1627098307598)

- 无法写入？

### 强制创建文件夹

- `:!mkdir -p  ~/.vim/view/`
- 然后`:mkview`
- 成功了
- 这个东西存在哪里呢？
- `:!ls ~/.vim/view/`
- 找到了这样一个文件 

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210724-1627098495432)

### view的内容
- 我们来看看这个里面有啥
- `:!ls ~/.vim/view/`
- 首先我们可以确定文件名
- `:!vi ~/.vim/view/`+<kbd>tab</kbd>
- 然后有很多的属性options

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210724-1627098655648)

- 这是一个vim文件
- 就像~/.vimrc一样
- 保存了当时的一些option
- 载入的时候会加载local的option到当前window
	- 因为用的命令是`:setlocal ...=...`
- 其实我主要关心的是折叠信息的保存还有光标位置的情况

### 重来
- 我们重新回到oeasy.java
- `:set foldcolumn=4`
	- 进行一些简单的折叠
- 把光标位置设置在8,20
- 然后`:mkview`
- 然后打开所有折叠
- 再`gg`
- 然后`:loadview`
- 发现一切都回来了！！！
- 我觉得这还是挺实用的

### 具体存储的信息

- 我们可以看到
- 除了`localoption`之外
- 折叠和位置的信息也可以保留到view中

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210724-1627099152315)

- 如果我关闭了再打开`oeasy.java`
- 还能`loadview`么？
- 试试

### 加载视图
- 重新打开`oeasy.java`
- `:loadview`
- 加载视图成功
- 这样就能回到上次编辑的位置了
- 但是我能够定义多个编辑位置么？
- 这样我就可以像切地图位置一样切换光标位置了？

### 多个视图view

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210724-1627107364966)

- 找一个位置比如(8,20)
	- 坐标可以在statusline里面的ruler中找到
	- 定义一个view
	- `:mkview`
- 再找一个位置(1,1)
	- `:mkview 1` 
- 恢复到第一个位置
	- `:loadview`
- 恢复到第二个位置
	- `:loadview 1`
- 总共九个数字可以给你用
- 还可以自定义view的名字
- 可以说是很方便了
- 随意传送
- 其实这个用`ma`也能做到
- 视图view里面是不只是可以保存光标位置
- 一个view里面到底保存了什么？

### view内容

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210724-1627108103600)

- 打开的文件列表(参数),也就是`:args`，包括索引顺序
- 当前文件
- 当前窗口的本地属性
	- 缩写(abbreviations)
	- 映射(mappings)
-  折叠(fold)
- 为什么可以保存这么多东西呢？

### view选项

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210724-1627109742310)

- `:h viewoptions`可以看到view保存内容的选项
- 可以选择保存什么不保存什么
- 内容是一个列表
- `:set viewoptions?`
- 目前是默认的
	- `:set viewoptions=folds,options,cursor,curdir`
- `curdir`指的是当前路径
	- 在使用`:view .`的时候可以明确相对路径
- view保存了好多配置信息，但是不会影响到最终编辑的文档
	- 是蓝布棉门帘
## 总结

- 这次了解到了`:mkview`、`:loadview`
- 保存和加载视图
- 保存的选项在`viewoption`中
- 还可以保存多个视图
	- 在整个文档中跳来跳去
- 视图里面可以有很多本地窗口的设置
	- 折叠
	- 缩写
	- 映射
- 那么到底什么是缩写和映射呢？🤔
- 下次再说！





