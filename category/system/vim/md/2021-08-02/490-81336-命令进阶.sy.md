---
show: step
version: 1.0
enable_checker: true
---

# 范围控制

## 回忆上节课内容🤔

- 我们这次研究vim的历史
- 为什么会有行编辑器这种东西
- 竟然是当年，没有显示器只有纸的时代的无奈之举
- vim进化到今天，依然还有好多人使用，而且ssh的时候直接vim就很方便
- 命令行还有什么好玩的么？🤔



### 缩进控制

- 我们学习过用<kbd><</kbd>、<kbd>></kbd>控制缩进
	- <kbd><</kbd>向左一个`shiftwidth`
	- <kbd>></kbd>向右一个`shiftwidth`
	- 如果忘了的话,可以`:h sw`
- 如果我们想要多行进行控制呢？
	- `:20,40>`，`20`到`40`行向右一个`shiftwidth`
	- `:'a,$>`，`a标记`到`结尾`向右一个`shiftwidth`
	- `%<`,所有行向左一个`shiftwidth`
	
![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210202-1612236787087)


### 范围添加分号结尾

- 我们如果想要给从4到10行添加分号结尾，应该如何呢？
- 首先是`range`,先打上`:4,10`
- 然后让这个范围内的东西进入normal格式再在行为插入`;`
	- `:4,10normal`切换为`normal`模式 
	- 打一个空格，后面打上命令`A;`,在最后的位置插入`;`
- 整体的命令为`:4,10normal A;`
- 思考如果我想在`8,15`行添加`//`应该如何做呢？
- 动手试一试！

### 进入命令模式

- 在Normal模式下直接按下<kbd>Q</kbd>
- 可以执行各种命令行
	- `:ls`
	- `:1,3d`
	- `:1,7p`
	- `:visual` 退回到正常模式

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210727-1627391724057)

- 但是这些都是执行`vim`的内部命令
- 我想要执行外部命令
- 比如shell的命令可以么？

### 跳到shell
- 我们知道我们是从shell运行vim然后进来的
- 如果我们想退出vim的话需要保存并退出`:wq`
- 如果我不想保存并退出
- 就想切到外面，把vim整个进程先挂起放到后台
	- 我们就 <kbd>ctrl</kbd>+<kbd>z</kbd>
- 在shell运行完命令之后
- `fg`就可以把`vim`切回到前台

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210727-1627391261299)

- 但是我们可以直接不挂起vim的情况下执行shell命令么？


### 直接执行外部命令

- 命令行的状态中可以直接执行外面的命令比如ls
- 我们在前面加上`!`就可以
- 比如`:!ls`
- 更复杂一些的`!javac oeasy.java`
- `!source o2z.sh`
- 这很方便，直接在vi里面就可以执行命令了，而且能看到报错的结果
- 可以直接修改，很爽！！！


### 搜索错误
- 如果没有保存文件就想`:q`的话
- 会报`E37`错误

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210705-1625455972593)

- 我们可以直接`:h E37`查询这个错误的详细信息

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210705-1625455978952)

## 总结
- 我们这次研究范围命令执行方法
- 批量控制缩进
	- `:20,40>`
- 批量执行普通模式下的命令
	- `:4,10normal A;`
- 执行外部命令
	- `!javac oeasy.java`
- 直接切换到`命令模式`
	- `:term`
- 这个方式真的很爽，在vi什么都干了！
- 命令模式本身可以提高效率吗？🤔
- 下次再说 👋






