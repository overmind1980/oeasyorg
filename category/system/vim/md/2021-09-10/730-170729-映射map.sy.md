---
show: step
version: 1.0
enable_checker: true
---

# 映射map

## 回忆上次缩写的细节

- 可以定义缩写
	- `:ab o1z oeasy`
- 可以定义到指定的模式
	- `iab`
	- `cab`
- 查看缩写
	- `:ab` - 所有的
	- `:ab o1z` - o1z
- 自动补全
	- <kbd>ctrl</kbd><kbd>p</kbd>
	- <kbd>ctrl</kbd><kbd>n</kbd>
- 这些缩写都可以保存在视图里
	- 保存的选项在`viewoption`中
- 可以保存的除了 `缩写` 还有个 `映射`
- `映射` 什么意思呢？🤔

### 关于映射
- 映射就是`map`
- 比如按下什么什么就相当于按下什么什么之类的
- 系统里面有 

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210812-1628736365605)

- 比如mac系统中修饰键设置的第一条
- 把 <kbd>CapsLock</kbd> 映射到 <kbd>Esc</kbd>
- 这样大写锁定就失效了
- 但是小拇指左移一下就可以到
- 超级方便
- 再也不用 <kbd>ctrl</kbd>+<kbd>c</kbd> 了
- 做实验的时候也好使
- 只要是按下<kbd>CapsLock</kbd> 
- 就相当于按下<kbd>Esc</kbd>
- 这就是 映射`map`

### 建立映射 -  mapping
- 快速进入命令模式
	- `:map ; :`
	- 把 `;` 映射成 `:`
	- 这样我们就可以不用摁下<kbd>shift</kbd>
	- 直接通过小拇指就可以进入命令模式了
	- 还是很方便的

### map 映射
- 我们可以使用
- `:map Y y$`定一个映射
	- `map`是命令的名字
	- `Y` 是被映射的键
	- `y$` 是映射到的键
- 从此按下`Y`，就相当于`y$`
- 我们来试一下
	- 在行的中间位置，按下Y
	- `:reg` 观察默认寄存器
- 现在复制的是从光标到结尾
- 我想要的是一整行，怎么办呢？

### 重新映射

- `:map! Y 0y$`定一个映射
	- `map`是命令的名字
	- `Y` 是被映射的键
	- `y$` 是映射到的键
- 可是我现在命令模式下只要Y就自动变成`0y$`
- 但是其实我们主要需要映射正常模式下的;
- 能否强调这一个点呢？


### 不同模式

- 不同模式有不同的映射map命令
	- `:map` 所有模式
	- `:vmap` 可视化模式 visual
	- `:nmap` 正常模式 normal
	- `:omap` operartor-pending 被定义的键可以作为一个motion来使用
	- `:map!` 插入和命令行模式
	- `:imap` 插入模式 insert 
	- `:cmap` 命令行模式 command
- 这样我们可以知道
- `:nmap ; :`
	- 在正常模式下把;换成:
	- 这样也就快速进入了命令模式

### 我们再试试Y
- 定义Y并验证
	- `:nmap Y y$`
	- `:reg "`
- 重新定义Y
	- `:nmap Y 0y$`
	- `:reg "`

### 观察映射
- `:map`可以观察所有已经存在的映射

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210724-1627138181156)

- 第一列是模式
- 第二列是映射触发键
- 第三列是映射对应处理方式
- 如果我们想查看插入模式下;对应什么操作
	- `:imap ;`
	- `:nmap Y`

### 映射为空
- 还记得我们取消方向键的操作吗？
	- `:map <LEFT> <nop>`
	- `:map <UP> <nop>`
	- `:map <RIGHT> <nop>`
	- `:map <DOWN> <nop>`
- <nop>就是什么都不做
	- 对应No Operation Performed 
	- 这原来是一条汇编指令，指令着让cpu空轮一个周期
- 但是我们现在想想
	- 我们为什么要禁掉方向键？
	- 是为了让手放在核心区不动
	- 但是这指的是Normal模式
- 如果是命令模式，我们怎么办？
- 我们需要方向键控制光标左右运动
- 也需要<kbd>shift</kbd>或<kbd>ctrl</kbd>配合方向键控制光标快速移动
- 也就是说Normal模式方向键不做任何事，Command模式下还可以用
- 所以
	- `:nmap <LEFT> <nop>`
	- `:nmap <UP> <nop>`
	- `:nmap <RIGHT> <nop>`
	- `:nmap <DOWN> <nop>`


### 避免重映射

- 什么是重映射
- 比如
	- `:ab @d adder`
	- `:map dd didi`
- 这个时候如果我们在插入模式下输入`@d`
- 会发生什么？

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210724-1627138655166)

- 那么这个东西如何处理呢？


### 取消重复缩写

- `:noreabbrev @a adder`
-   这个时候@a就是对应adder
-   不管dd对应什么
-   都不会对于adder进行任何的重复缩写

### 取消重复映射

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210724-1627138850797)

- 这样可以避免两个东西交叉互相映射
- 也可以避免映射到想不到的地方
- 需要避免歧义
- 不过有的时候歧义不可避免

### 歧义
- 我们定义了两个映射
	- `:map aa oeasy`
	- `:map aaa o2z`
- 这个时候我们输入aa会如何？
- 试一下
- 输入aa之后他会等待
- 如果下一个是<kbd>Space</kbd>或者<kbd>CR</kbd>
	- 那么对应`oeasy`
- 如果下一个是a
	- 那么对应`o2z`
- 这种map映射和缩写abbreviate很像啊
- 缩写就很像是插入模式下的一种特殊的映射
- 不过两者还是有不同的
- 两者有什么不同呢？

### 比较映射和缩写


- 不同点
	- 侧重模式不同
		- 缩写侧重于输入(对应插入和命令行模式)
		- 映射可以存在于更多模式
	- 触发条件不同
		- 缩写在插入模式下按回车或者空格或tab就可以触发
		- 映射要有自己对应的按键
	- 效果不同
		- 缩写就是把缩写形式补全成完整形式，原缩写形式消失
		- 映射可以做更多的操作
- 相同点
	- 首先他们都是为了快速输入和操作而存在的
	- 他们都可以取消重复
		- `noremap`
		- `noreabbrev`
	
## 总结

- 这次了解到了`:map`映射
- 可以定义映射
	- `:map ; :`
- 查询映射
	- `:map`
	- `:map ;`
- 还可以取消映射
	- `:unmap`
- 可以映射到指定的模式
	- `:map` 所有模式
	- `:vmap` 可视化模式 visual
	- `:nmap` 正常模式 normal
	- `:omap` operartor-pending 被定义的键可以作为一个motion来使用
	- `:map!` 插入和命令行模式
	- `:imap` 插入模式 insert 
	- `:cmap` 命令行模式 command

- 可以映射到什么也不做
	- `:nmap h <nop>`
- 还可以避免再次映射
	- `:noreabbrev o1z oeasy` 
- 最后我们比较了缩写和映射的异同
	- 这 `缩写` 和 `映射` 都是可以`:mkview`保存的
	- 也可以写到`~/.vimrc`作为基础映射
	- 还可以写到具体的 `filetype` 中做一些专门的操作
- 但是其实101键盘上面很多功能键
	- <kbd>f1</kbd>-<kbd>f12</kbd>
	- 我们还没有用上
- 可以给他们映射上么？🤔
- 下次再说！





